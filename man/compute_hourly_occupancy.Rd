% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_hourly_occupancy.R
\name{compute_hourly_occupancy}
\alias{compute_hourly_occupancy}
\title{Compute hourly patient occupancy for psychiatry units}
\usage{
compute_hourly_occupancy(
  data,
  unit_col = unit_code,
  admission_col = admission,
  discharge_col = discharge,
  tz = "UTC"
)
}
\arguments{
\item{data}{A data frame containing psychiatric admission and discharge data,
typically this would be the MB data.}

\item{unit_col}{The name of the column identifying units (default: \code{unit_code}).}

\item{admission_col}{The name of the admission date-time column (default: \code{admission}).}

\item{discharge_col}{The name of the discharge date-time column (default: \code{discharge}).}

\item{tz}{Time zone to use for generating hourly timestamps (default: \code{"UTC"}).}
}
\value{
A tibble with columns:
\itemize{
\item \code{unit_code} (or the column provided in \code{unit_col}),
\item \code{Hour} — hourly timestamps for the representative year,
\item \code{n_patients} — number of patients in each unit at that hour.
}
}
\description{
This function generates an hourly time sequence for the representative year
of the provided MB dataset and computes hourly patient occupancy for each
psychiatric unit.

The function first checks whether the dataset primarily represents a single
year, based on the values in \code{admission_col}, while allowing for minor
deviations or outliers. If the 10\% and 90\% year quantiles and median are
identical, the function proceeds with that year; otherwise, it also proceeds
butissues a warning message.

It then generates an hourly sequence for the identified year, performs a
cross join with the distinct unit codes, and calculates the number of
patients present in each unit at every hour of the year.
}
\examples{
\dontrun{
occupancy_tbl <- compute_hourly_occupancy(dat$MB_filtered)
head(occupancy_tbl)
}

}
